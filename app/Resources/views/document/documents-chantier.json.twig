{% import 'tools.html.twig' as tools %}

[{% for folder in chantier.dossiers -%}
    {% if folder.parent %}
        {{ { "id" : "folder-" ~ folder.id, "parent" : "folder-" ~ folder.parent.id, "type": "folder", "text" : folder.nom|e }|json_encode|raw }}
    {% else %}
        {{ { "id" : "folder-" ~ folder.id, "parent" : "#", "type": "folder", "text" : folder.nom|e }|json_encode|raw }}
    {% endif %}
    {%- if not loop.last %},{% endif -%}
{% endfor %}
{% for doc in chantier.documents -%}
    {%- if loop.first %},{% endif -%}
    {% if doc.parent %}
        {{ { "id" : "file-" ~ doc.id, "parent" : "folder-" ~ doc.parent.id, "type": "file", "text" : doc.nom|e, "icon": asset('img/file-icons/small/') ~ tools.file_icon(doc.mimeType)|trim }|json_encode|raw }}
    {% else %}
        {{ { "id" : "file-" ~ doc.id, "parent" : "#", "type": "file", "text" : doc.nom|e, "icon": asset('img/file-icons/small/') ~ tools.file_icon(doc.mimeType)|trim }|json_encode|raw }}
    {% endif %}
    {# use "value" instead of "id" key, if you use jquery-ui #}
    {%- if not loop.last %},{% endif -%}
{% endfor %}]
